<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸœ ë¼ë©´ íƒ€ì´ë¨¸ PRO â€“ ë‹¨ì¼ HTML</title>
<style>
  :root{
    --bg:#f7f7fb;--card:#fff;--ink:#111;--muted:#6b7280;--ring:#e5e7eb;--brand:#111827;
    --y:#fde68a;--g:#86efac;--gray:#d1d5db
  }
  *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif}
  .wrap{max-width:1120px;margin:0 auto;padding:24px}
  h1{font-size:clamp(22px,2.5vw,32px);margin:0 0 8px;font-weight:800}
  .sub{font-size:12px;color:var(--muted)}
  .card{background:var(--card);border:1px solid var(--ring);border-radius:16px;box-shadow:0 2px 8px rgba(0,0,0,.04)}
  .p4{padding:16px}.p6{padding:24px}.grid{display:grid;gap:16px}
  @media(min-width:980px){.two{grid-template-columns:1fr 1fr}}
  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  .btn{border:1px solid var(--ring);background:#fff;border-radius:12px;padding:8px 12px;cursor:pointer}
  .btn.primary{background:var(--brand);color:#fff}
  .btn.ghost{background:#fff}
  .btn[aria-pressed="true"]{background:var(--brand);color:#fff}
  input,select,textarea{border:1px solid var(--ring);border-radius:12px;padding:10px 12px;width:100%;background:#fff}
  .tag{border:1px solid var(--ring);border-radius:12px;padding:8px 12px;background:#fff;cursor:pointer}
  .tag.active{background:var(--brand);color:#fff}
  .muted{color:var(--muted);font-size:12px}
  .timer{display:flex;flex-direction:column;align-items:center;justify-content:center;border:1px solid var(--ring);border-radius:16px;background:#fafafa}
  .time{font-weight:900;font-size:64px;letter-spacing:1px}
  .stage{font-weight:800;font-size:20px;margin-bottom:8px}
  .bar{display:flex;gap:8px;margin-top:16px}
  .dot{height:8px;flex:1;border-radius:999px;background:var(--gray)}
  .dot.past{background:var(--g)}.dot.cur{background:var(--y)}
  details summary{cursor:pointer;font-weight:700}
  .tbl{display:grid;grid-template-columns:1fr;gap:12px}
  @media(min-width:700px){.tbl{grid-template-columns:1fr 1fr}}
  .k{font-weight:700}
  footer{color:var(--muted);font-size:12px;text-align:center;padding:24px 0}
</style>
</head>
<body>
  <div class="wrap grid">
    <header class="row" style="justify-content:space-between">
      <div>
        <h1>ğŸœ ë¼ë©´ íƒ€ì´ë¨¸ PRO</h1>
        <div class="sub">ëŒ€í‘œ 10ì¢… ìµœì  ë ˆì‹œí”¼ Â· ë‹¨ê³„ë³„ íƒ€ì´ë¨¸ Â· ê°€ì—´ì‹œê°„ Â· ì•Œë¦¼ Â· ì»¤ìŠ¤í…€ ë ˆì‹œí”¼</div>
      </div>
      <div class="sub">ê°œë°œì: <b>ê°€ì¹˜ìˆëŠ”ë¯¸ë˜êµìœ¡ì—°êµ¬ì†Œ ëŒ€í‘œ ê¹€ë³‘ì°¬</b></div>
    </header>

    <!-- ë ˆì‹œí”¼ ìš”ì•½ -->
    <section class="card p4">
      <details>
        <summary>ëŒ€í‘œ ë¼ë©´ 10ì¢… ìµœì  ë ˆì‹œí”¼ ìš”ì•½ ë³´ê¸°</summary>
        <div id="recipeSummary" class="tbl" style="margin-top:12px"></div>
      </details>
    </section>

    <!-- ì»¨íŠ¸ë¡¤ & íƒ€ì´ë¨¸ -->
    <section class="card p6 grid two">
      <div class="grid" id="controls">
        <div>
          <label class="k">ë¼ë©´ ì„ íƒ</label>
          <select id="ramenSelect"></select>
        </div>
        <div class="grid" style="grid-template-columns:1fr 1fr">
          <div class="p4 card" style="padding:12px"><span class="muted">ì œì¡°ì‚¬</span><div id="maker" class="k"></div></div>
          <div class="p4 card" style="padding:12px"><span class="muted">ê¶Œì¥ ë¬¼</span><div id="water" class="k"></div></div>
        </div>

        <div class="grid">
          <div class="k">ê°€ì—´ ì‹œê°„(ë¬¼ ë“ì´ê¸°) ì¶”ê°€</div>
          <div class="row">
            <button class="btn" data-preheat="ì—†ìŒ" data-sec="0">ì—†ìŒ</button>
            <button class="btn" data-preheat="ê°€ìŠ¤ë ˆì¸ì§€(ë³´í†µ)" data-sec="180">ê°€ìŠ¤ë ˆì¸ì§€(ë³´í†µ)</button>
            <button class="btn" data-preheat="ì¸ë•ì…˜(ë¹ ë¦„)" data-sec="90">ì¸ë•ì…˜(ë¹ ë¦„)</button>
            <span class="muted">ì‚¬ìš©ì ì§€ì •(ì´ˆ)</span>
            <input id="preheatCustom" type="number" min="0" value="0" style="width:96px"/>
          </div>
          <div class="muted">ê°€ì—´ ë‹¨ê³„ëŠ” íƒ€ì´ë¨¸ì˜ ì²« ë‹¨ê³„ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤(í™˜ê²½ë³„ í¸ì°¨ ì¡´ì¬).</div>
        </div>

        <div>
          <div class="k">í† í•‘ ì„ íƒ</div>
          <div id="toppings" class="row"></div>
        </div>

        <div id="eggBox" class="muted">
          <div class="k">ê³„ë€ ìµí˜</div>
          <label class="tag" style="display:inline-block"><input type="radio" name="egg" value="soft"> ë°˜ìˆ™(â‰ˆ45ì´ˆ)</label>
          <label class="tag" style="display:inline-block"><input type="radio" name="egg" value="hard"> ì™„ìˆ™(â‰ˆ2ë¶„)</label>
        </div>

        <div class="grid">
          <div class="k">ì•Œë¦¼ìŒ / ë¸Œë¼ìš°ì € ì•Œë¦¼</div>
          <div class="row">
            <button class="btn" data-sound="beep">ì‚‘</button>
            <button class="btn" data-sound="bell">ë²¨</button>
            <button class="btn" data-sound="wood">ìš°ë“œ</button>
            <button class="btn" data-sound="mute">ë¬´ìŒ</button>
            <button class="btn" id="testSound">í…ŒìŠ¤íŠ¸</button>
          </div>
          <div class="muted">ë‹¨ê³„ ì „í™˜/ì™„ë£Œ ì‹œ íš¨ê³¼ìŒê³¼ ë°ìŠ¤í¬í†± ì•Œë¦¼(ê¶Œí•œ í•„ìš”)ì„ ë³´ëƒ…ë‹ˆë‹¤.</div>
        </div>
      </div>

      <div class="timer p6">
        <div class="muted">í˜„ì¬ ë‹¨ê³„</div>
        <div class="stage" id="stageLabel">ì¤€ë¹„</div>
        <div class="time" id="time">00:00</div>
        <div class="bar" id="progress"></div>
        <div class="row" style="margin-top:16px">
          <button id="start" class="btn primary">ì‹œì‘</button>
          <button id="pause" class="btn">ì¼ì‹œì •ì§€</button>
          <button id="reset" class="btn">ë¦¬ì…‹</button>
        </div>
      </div>
    </section>

    <!-- ì„ íƒ ë ˆì‹œí”¼ ìƒì„¸ -->
    <section class="card p6">
      <h3 class="k" id="detailTitle"></h3>
      <ul id="detailList" style="margin-top:8px"></ul>
      <div class="muted" style="margin-top:8px">í‘œê¸° ì‹œê°„ì€ í™˜ê²½Â·ê¸°í˜¸ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
    </section>

    <!-- ì»¤ìŠ¤í…€ ë ˆì‹œí”¼ ë¹Œë” -->
    <section class="card p6">
      <h3 class="k">â• ì»¤ìŠ¤í…€ ë ˆì‹œí”¼ ì¶”ê°€</h3>
      <div class="grid" style="grid-template-columns:1fr 1fr;gap:16px">
        <div class="grid">
          <label class="k">ë ˆì‹œí”¼ ì´ë¦„</label>
          <input id="cName" placeholder="ì˜ˆ) ìš°ë¦¬ì§‘ ë¼ë³¶ì´"/>
          <div class="grid" style="grid-template-columns:1fr 1fr;gap:8px">
            <div>
              <label class="k">ì œì¡°ì‚¬/ì¶œì²˜</label>
              <input id="cMaker" placeholder="ì˜ˆ) ì§‘ ë ˆì‹œí”¼"/>
            </div>
            <div>
              <label class="k">ê¶Œì¥ ë¬¼</label>
              <input id="cWater" placeholder="ì˜ˆ) 500 ml"/>
            </div>
          </div>
          <label class="k">ë ˆì‹œí”¼ ì„¤ëª…(í•œ ì¤„ë‹¹ 1í•­ëª©)</label>
          <textarea id="cSteps" rows="6" placeholder="ì˜ˆ) ë©´ 3ë¶„ ì‚¶ê¸°&#10;ì˜ˆ) ì†ŒìŠ¤ ë„£ê³  30ì´ˆ ë²„ë¬´ë¦¬ê¸°"></textarea>
        </div>
        <div class="grid">
          <div class="row" style="justify-content:space-between"><span class="k">íƒ€ì´ë¨¸ ë‹¨ê³„</span><button id="addStage" class="btn">ë‹¨ê³„ ì¶”ê°€</button></div>
          <div id="stageRows" class="grid"></div>
          <button id="saveCustom" class="btn primary">ì €ì¥</button>
          <div class="muted">ì €ì¥ëœ ì»¤ìŠ¤í…€ ë ˆì‹œí”¼ëŠ” ë¸Œë¼ìš°ì €(LocalStorage)ì— ë³´ê´€ë©ë‹ˆë‹¤.</div>
        </div>
      </div>
    </section>

    <footer>Â© <span id="y"></span> ê°€ì¹˜ìˆëŠ”ë¯¸ë˜êµìœ¡ì—°êµ¬ì†Œ Â· ê°œë°œ: ê¹€ë³‘ì°¬</footer>
  </div>

<script>
// ===== ë°ì´í„° =====
const BASE_RECIPES = {
  "ì‹ ë¼ë©´":{maker:"ë†ì‹¬",water:"550 ml",steps:["ë¬¼ 550 ml ë“ì´ê¸°","ë©´+ë¶„ë§ìŠ¤í”„Â·ê±´ë”ê¸°","3ë¶„ 30ì´ˆ ë“ì¸ ë’¤ ê³„ë€/ì¹˜ì¦ˆ 1ë¶„","ëŒ€íŒŒÂ·ìˆ™ì£¼ ë“± ì¶”ê°€(ì§„í•˜ê²Œ: ë¬¼ 500 ml)"],baseStages:[{label:"ë©´+ìŠ¤í”„ ë“ì´ê¸°",seconds:210},{label:"ë§ˆë¬´ë¦¬ ë“ì´ê¸°",seconds:60}]},
  "ë„ˆêµ¬ë¦¬":{maker:"ë†ì‹¬",water:"550 ml",steps:["ë©´+ìŠ¤í”„ 5ë¶„","ì–´ë¬µÂ·í•´ë¬¼Â·ëŒ€íŒŒ","ë§¤ìš´ë§›ì€ ì²­ì–‘ê³ ì¶”"],baseStages:[{label:"ë©´+ìŠ¤í”„ ë“ì´ê¸°",seconds:300}]},
  "ì§œíŒŒê²Œí‹°":{maker:"ë†ì‹¬",water:"600 ml",steps:["ë©´ 5ë¶„ ì‚¶ê¸°","ë¬¼ 8ìŠ¤í‘¼ ë‚¨ê¸°ê³  ë²„ë¦¬ê¸°","ìœ ì„±ìŠ¤í”„+ë¶„ë§ìŠ¤í”„ ë¹„ë¹„ê¸° (ì¹˜ì¦ˆ/ê³„ë€í›„ë¼ì´)"],baseStages:[{label:"ë©´ ì‚¶ê¸°",seconds:300}]},
  "ì§œì™•":{maker:"ë†ì‹¬",water:"í¬ì¥ ê¸°ì¤€",steps:["í¬ì¥ ê¸°ì¤€ ë©´ ì‚¶ê¸°","ì˜¤ì¼ ë„£ê³  ë¹„ë¹„ê¸°","ê³„ë€í›„ë¼ì´Â·ì–‘íŒŒ ë³¶ìŒ"],baseStages:[{label:"ë©´ ì‚¶ê¸°(í¬ì¥ ê¸°ì¤€)",seconds:270}]},
  "ì•ˆì„±íƒ•ë©´":{maker:"ë†ì‹¬",water:"550 ml",steps:["ë©´+ìŠ¤í”„ 4ë¶„","(3:30 ë’¤ í† í•‘)","ê¹»ìÂ·ëŒ€íŒŒÂ·ê³„ë€"],baseStages:[{label:"ë©´+ìŠ¤í”„ ë“ì´ê¸°",seconds:240}]},
  "ë¶ˆë‹­ë³¶ìŒë©´":{maker:"ì‚¼ì–‘",water:"ë“ëŠ” ë¬¼ 600 ml",steps:["ë©´ 5ë¶„","ë¬¼ ëŒ€ë¶€ë¶„ ë²„ë¦¼(2~8ìŠ¤í‘¼ ë‚¨ê¹€)","ì•¡ìƒì†ŒìŠ¤ + 30ì´ˆ ë³¶ê¸°","ì¹˜ì¦ˆ ì˜¬ë ¤ ë…¹ì´ê¸°"],baseStages:[{label:"ë©´ ì‚¶ê¸°",seconds:300},{label:"ë³¶ìŒ/ë²„ë¬´ë¦¬ê¸°",seconds:30}]},
  "ì‚¼ì–‘ë¼ë©´":{maker:"ì‚¼ì–‘",water:"550 ml",steps:["ë¶„ë§ìŠ¤í”„ ë¨¼ì €","ë©´ 3~4ë¶„","íŒŒ/ë²„ì„¯/ê³„ë€"],baseStages:[{label:"ë©´+ìŠ¤í”„ ë“ì´ê¸°",seconds:210}]},
  "ì§„ë¼ë©´":{maker:"ì˜¤ëšœê¸°",water:"550 ml",steps:["ê±´ë”ê¸° ë¨¼ì € ìš°ë ¤ë‚´ê¸°","ë¶„ë§ìŠ¤í”„Â·ë©´ 4ë¶„","ê¹€ì¹˜Â·ëŒ€íŒŒÂ·ê³„ë€Â·ë§Œë‘"],baseStages:[{label:"ë©´+ìŠ¤í”„ ë“ì´ê¸°",seconds:240}]},
  "ë¹„ë¹”ë©´":{maker:"íŒ”ë„",water:"500~600 ml",steps:["ë©´ 3ë¶„","ì°¬ë¬¼ í—¹ê¶ˆ ë¬¼ê¸° ì œê±°","ì†ŒìŠ¤+ì˜¤ì´+ì‚¶ì€ê³„ë€","ë¬¼ë¹„ë¹” ë³€í˜•"],baseStages:[{label:"ë©´ ì‚¶ê¸°",seconds:180}]},
  "ì™•ëšœê»‘(ì»µ/ë´‰ì§€)":{maker:"íŒ”ë„",water:"ì»µ: í‘œì‹œì„ ",steps:["ì»µ: ëœ¨ê±°ìš´ ë¬¼ 3~3.5ë¶„","ë¬¼ 4ìŠ¤í‘¼ ë‚¨ê¸°ê³  ë²„ë¦¬ê³  ë¹„ë¹„ê¸°(ì§œì¥í˜•)","ë´‰ì§€: í‘œê¸°ëŒ€ë¡œ"],baseStages:[{label:"ì»µë©´ ìš°ë ¤ë‘ê¸°",seconds:210}]}
};
const TOPPINGS=["ë–¡êµ­ë–¡","íŒŒ","ì¹˜ì¦ˆ","ê³„ë€"];
const EGG_STAGES={soft:{label:"ê³„ë€ ë°˜ìˆ™(ë¼ë©´ ìœ„)",seconds:45},hard:{label:"ê³„ë€ ì™„ìˆ™(ë¼ë©´ ìœ„)",seconds:120}};

// ===== ìƒíƒœ =====
let custom = JSON.parse(localStorage.getItem("ramen_custom_recipes")||"{}");
let RECIPES = {...BASE_RECIPES, ...custom};
let chosen = Object.keys(RECIPES)[0] || "ì‹ ë¼ë©´";
let toppingsSel = {};
let eggType = "soft";
let preheatMode = "ì—†ìŒ"; let preheatSec = 0;
let sound = "beep"; // beep|bell|wood|mute
let stages = []; let stageIdx = 0; let secondsLeft = 0; let running=false; let interval=null;

// ===== DOM ì°¸ì¡° =====
const $select = document.getElementById('ramenSelect');
const $maker = document.getElementById('maker');
const $water = document.getElementById('water');
const $detailTitle = document.getElementById('detailTitle');
const $detailList = document.getElementById('detailList');
const $stageLabel = document.getElementById('stageLabel');
const $time = document.getElementById('time');
const $bar = document.getElementById('progress');
const $toppings = document.getElementById('toppings');
const $eggBox = document.getElementById('eggBox');
const $preheatCustom = document.getElementById('preheatCustom');
const $summary = document.getElementById('recipeSummary');

// ===== ìœ í‹¸ =====
const fmt = s=>{s=Math.max(0,s|0);const m=String((s/60)|0).padStart(2,'0');const sec=String(s%60).padStart(2,'0');return `${m}:${sec}`};
function renderSummary(){
  $summary.innerHTML = Object.entries(RECIPES).map(([k,v])=>`
    <div class="card p4">
      <div class="row" style="justify-content:space-between;margin-bottom:6px">
        <div class="k">${k}</div>
        <div class="muted">ì œì¡°ì‚¬: ${v.maker} Â· ë¬¼: ${v.water}</div>
      </div>
      <ul style="margin:0;padding-left:18px">${(v.steps||[]).map(s=>`<li>${s}</li>`).join('')}</ul>
    </div>`).join('');
}
function renderSelect(){
  $select.innerHTML = Object.keys(RECIPES).map(k=>`<option value="${k}">${k}</option>`).join('');
  $select.value = chosen;
}
function renderToppings(){
  $toppings.innerHTML = TOPPINGS.map(t=>{
    const active = !!toppingsSel[t];
    return `<label class="tag ${active?'active':''}"><input type="checkbox" ${active?'checked':''} data-top="${t}" style="display:none"> ${t}</label>`;
  }).join('');
}
function renderEggBox(){
  $eggBox.style.opacity = toppingsSel['ê³„ë€']? '1' : '.5';
  $eggBox.querySelectorAll('input[name="egg"]').forEach(r=>{ r.checked = (r.value===eggType); r.disabled = !toppingsSel['ê³„ë€']; });
}
function buildStages(){
  stages=[];
  if(preheatMode!=="ì—†ìŒ" && preheatSec>0) stages.push({label:`ë¬¼ ë“ì´ê¸°(${preheatMode})`,seconds:preheatSec});
  stages.push(...(RECIPES[chosen].baseStages||[]));
  if(toppingsSel['ê³„ë€']) stages.push(EGG_STAGES[eggType]);
}
function reset(){
  stageIdx=0; secondsLeft=stages[0]?.seconds||0; updateTimerUI();
}
function updateTimerUI(){
  $stageLabel.textContent = stages[stageIdx]?.label || 'ì¤€ë¹„';
  $time.textContent = fmt(secondsLeft||0);
  $bar.innerHTML = stages.map((s,i)=>`<div class="dot ${i<stageIdx?'past':i===stageIdx?'cur':''}" title="${s.label} Â· ${fmt(s.seconds)}"></div>`).join('');
}
function updateRecipePanel(){
  const r = RECIPES[chosen];
  $maker.textContent = r.maker || '-';
  $water.textContent = r.water || '-';
  $detailTitle.textContent = `${chosen} Â· ìµœì  ë ˆì‹œí”¼`;
  $detailList.innerHTML = (r.steps||[]).map(s=>`<li>${s}</li>`).join('');
}
function playTone(kind='beep'){
  if(kind==='mute') return;
  try{
    const Actx = window.AudioContext||window.webkitAudioContext; const ctx = new Actx();
    const o = ctx.createOscillator(); const g = ctx.createGain(); o.connect(g); g.connect(ctx.destination);
    if(kind==='beep'){o.type='sine'; o.frequency.value=880; g.gain.value=.05; o.start(); setTimeout(()=>{o.stop();ctx.close();},160)}
    if(kind==='bell'){o.type='triangle'; g.gain.value=.06; o.frequency.value=700; o.start(); setTimeout(()=>o.frequency.value=1200,120); setTimeout(()=>{o.stop();ctx.close();},340)}
    if(kind==='wood'){o.type='square'; g.gain.value=.05; o.frequency.value=500; o.start(); setTimeout(()=>g.gain.exponentialRampToValueAtTime(.0001,ctx.currentTime+.2),50); setTimeout(()=>{o.stop();ctx.close();},260)}
  }catch{}
}
function notify(text){
  try{ if(!('Notification' in window))return; if(Notification.permission==='granted') new Notification(text);}catch{}
}
function reqNotify(){ try{ if(!('Notification' in window))return; if(Notification.permission==='default') Notification.requestPermission(); }catch{}
}

// ===== ì´ˆê¸° ë Œë” =====
renderSummary();
renderSelect();
renderToppings();
renderEggBox();
buildStages();
reset();
updateRecipePanel();

document.getElementById('y').textContent = new Date().getFullYear();

// ===== ì´ë²¤íŠ¸ ë°”ì¸ë”© =====
$select.addEventListener('change',e=>{chosen=e.target.value; running&&pause(); buildStages(); reset(); updateRecipePanel();});

// ê°€ì—´ ë²„íŠ¼
Array.from(document.querySelectorAll('[data-preheat]')).forEach(btn=>{
  btn.addEventListener('click',()=>{
    Array.from(document.querySelectorAll('[data-preheat]')).forEach(b=>b.setAttribute('aria-pressed','false'));
    btn.setAttribute('aria-pressed','true');
    preheatMode=btn.dataset.preheat; preheatSec=Number(btn.dataset.sec||0); buildStages(); reset();
  });
});
$preheatCustom.addEventListener('input',e=>{ preheatMode='ì‚¬ìš©ì ì§€ì •'; preheatSec=Math.max(0, Number(e.target.value)||0); buildStages(); reset(); });

// í† í•‘
$toppings.addEventListener('click',e=>{
  const inp = e.target.closest('label')?.querySelector('input[data-top]');
  if(!inp) return; inp.checked=!inp.checked; toppingsSel[inp.dataset.top]=inp.checked; renderToppings(); renderEggBox(); buildStages(); reset();
});

// ê³„ë€
$eggBox.addEventListener('change',e=>{ if(e.target.name==='egg'){ eggType=e.target.value; buildStages(); reset(); }});

// ì‚¬ìš´ë“œ
Array.from(document.querySelectorAll('[data-sound]')).forEach(btn=>{
  btn.addEventListener('click',()=>{ Array.from(document.querySelectorAll('[data-sound]')).forEach(b=>b.setAttribute('aria-pressed','false')); btn.setAttribute('aria-pressed','true'); sound=btn.dataset.sound; });
});

document.getElementById('testSound').addEventListener('click',()=>{ reqNotify(); playTone(sound); });

// íƒ€ì´ë¨¸
function start(){ if(!stages.length) return; reqNotify(); if(running) return; running=true; if(!secondsLeft) secondsLeft=stages[stageIdx].seconds; clearInterval(interval); interval=setInterval(()=>{ secondsLeft--; if(secondsLeft<=0){ nextStage(); } updateTimerUI(); },1000);} 
function pause(){ running=false; clearInterval(interval);} 
function nextStage(){ const next=stageIdx+1; if(next<stages.length){ stageIdx=next; secondsLeft=stages[next].seconds; playTone(sound); notify('ë‹¤ìŒ ë‹¨ê³„: '+stages[next].label);} else { pause(); secondsLeft=0; playTone('bell'); notify('ë¼ë©´ ì™„ì„±! ë§›ìˆê²Œ ë“œì„¸ìš” ğŸœ'); }}

document.getElementById('start').addEventListener('click',start);
document.getElementById('pause').addEventListener('click',pause);
document.getElementById('reset').addEventListener('click',()=>{ pause(); buildStages(); reset(); });

// ===== ì»¤ìŠ¤í…€ ë ˆì‹œí”¼ ë¹Œë” =====
const $cName=document.getElementById('cName');
const $cMaker=document.getElementById('cMaker');
const $cWater=document.getElementById('cWater');
const $cSteps=document.getElementById('cSteps');
const $rows=document.getElementById('stageRows');
const $add=document.getElementById('addStage');
const $save=document.getElementById('saveCustom');

function rowTmpl(i,label='ë‹¨ê³„ '+(i+1),sec=60){return `<div class="row"><input data-lab placeholder="ë‹¨ê³„ ë¼ë²¨" value="${label}"/><input type="number" min="1" data-sec value="${sec}" style="width:120px"><button class="btn" data-del>âˆ’</button></div>`}
function renderRows(){ if(!$rows.children.length) $rows.insertAdjacentHTML('beforeend', rowTmpl(0,'ë‹¨ê³„ 1',180)); }
renderRows();
$add.addEventListener('click',()=>{ $rows.insertAdjacentHTML('beforeend', rowTmpl($rows.children.length)); });
$rows.addEventListener('click',e=>{ if(e.target.hasAttribute('data-del')) e.target.parentElement.remove(); });

$save.addEventListener('click',()=>{
  const name = $cName.value.trim(); if(!name) return alert('ë ˆì‹œí”¼ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.');
  const maker = $cMaker.value.trim()||'ì»¤ìŠ¤í…€'; const water = $cWater.value.trim()||'í‘œê¸° ê¸°ì¤€';
  const steps = $cSteps.value.split(/\n/).map(s=>s.trim()).filter(Boolean);
  const stgs = Array.from($rows.querySelectorAll('.row')).map(r=>({ label:r.querySelector('[data-lab]').value||'ë‹¨ê³„', seconds:Math.max(1, Number(r.querySelector('[data-sec]').value)||60) }));
  custom[name]={ maker, water, steps, baseStages: stgs };
  localStorage.setItem('ramen_custom_recipes', JSON.stringify(custom));
  RECIPES = {...BASE_RECIPES, ...custom};
  chosen = name; renderSummary(); renderSelect(); updateRecipePanel(); buildStages(); reset(); alert('ì»¤ìŠ¤í…€ ë ˆì‹œí”¼ ì €ì¥ ì™„ë£Œ!');
  $cName.value=''; $cMaker.value=''; $cWater.value=''; $cSteps.value=''; $rows.innerHTML=''; renderRows();
});
</script>
</body>
</html>
