import React, { useEffect, useMemo, useRef, useState } from "react";

/**
 * ë¼ë©´ íƒ€ì´ë¨¸ PRO (React/TSX í˜¸í™˜)
 * - ì´ì „/ë‹¤ìŒ ë‹¨ê³„ ë²„íŠ¼
 * - ë‹¤ìŒ ë‹¨ê³„ë¡œ ì´ë™í•´ë„ ìë™ ì‹œì‘ ì•ˆ í•¨(ì‚¬ìš©ìê°€ "ì‹œì‘"ì„ ëˆŒëŸ¬ì•¼ ì¹´ìš´íŠ¸ë‹¤ìš´ ì§„í–‰)
 * - ê°€ì—´(ë¬¼ ë“ì´ê¸°) ì‹œê°„ ì¶”ê°€, í† í•‘(ê³„ë€ ë°˜ìˆ™/ì™„ìˆ™) ë°˜ì˜, ì•Œë¦¼ìŒ(ì„ íƒ/í…ŒìŠ¤íŠ¸)
 * - ê°œë°œì í‘œê¸°: ê°€ì¹˜ìˆëŠ”ë¯¸ë˜êµìœ¡ì—°êµ¬ì†Œ ëŒ€í‘œ ê¹€ë³‘ì°¬
 *
 * â›³ ì˜¤ë¥˜ ì›ì¸: HTML ë¬¸ì„œë¥¼ TSXë¡œ íŒŒì‹±í•˜ë ¤ë‹¤ ì‹¤íŒ¨(/index.tsx: Unexpected token).
 *    â†’ HTML ì „ì²´ ë¬¸ì„œê°€ ì•„ë‹ˆë¼ **React ì»´í¬ë„ŒíŠ¸**ë¡œ ì¬ì‘ì„±í•˜ì—¬ í•´ê²°.
 */

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ë°ì´í„° ëª¨ë¸
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const RECIPES: Record<string, {
  water: string;
  steps: string[];
  stages: { label: string; seconds: number }[];
}> = {
  "ì‹ ë¼ë©´": {
    water: "550 ml",
    steps: ["ë¬¼ 550 ml ë“ì´ê¸°", "ë©´+ìŠ¤í”„ 3ë¶„30ì´ˆ", "í† í•‘ ì¶”ê°€ 1ë¶„"],
    stages: [
      { label: "ë©´+ìŠ¤í”„", seconds: 210 },
      { label: "ë§ˆë¬´ë¦¬", seconds: 60 },
    ],
  },
  "ë„ˆêµ¬ë¦¬": {
    water: "550 ml",
    steps: ["ë©´+ìŠ¤í”„ 5ë¶„", "í•´ë¬¼, íŒŒ ì¶”ê°€"],
    stages: [{ label: "ë©´+ìŠ¤í”„", seconds: 300 }],
  },
  "ì§œíŒŒê²Œí‹°": {
    water: "600 ml",
    steps: ["ë©´ 5ë¶„", "ë¬¼ 8ìŠ¤í‘¼ ë‚¨ê¸°ê³  ë²„ë¦¬ê¸°", "ìŠ¤í”„ ë¹„ë¹„ê¸°"],
    stages: [{ label: "ë©´ ì‚¶ê¸°", seconds: 300 }],
  },
  "ì•ˆì„±íƒ•ë©´": {
    water: "550 ml",
    steps: ["ë©´+ìŠ¤í”„ 4ë¶„", "ê¹»ì, ê³„ë€"],
    stages: [{ label: "ë©´+ìŠ¤í”„", seconds: 240 }],
  },
  "ë¶ˆë‹­ë³¶ìŒë©´": {
    water: "600 ml",
    steps: ["ë©´ 5ë¶„", "ë¬¼ ì¡°ê¸ˆ ë‚¨ê¸°ê³  ë²„ë¦¬ê¸°", "ì†ŒìŠ¤ ë„£ê³  30ì´ˆ ë³¶ê¸°"],
    stages: [
      { label: "ë©´ ì‚¶ê¸°", seconds: 300 },
      { label: "ë³¶ê¸°", seconds: 30 },
    ],
  },
};

const EGG_STAGES = {
  soft: { label: "ê³„ë€ ë°˜ìˆ™", seconds: 45 },
  hard: { label: "ê³„ë€ ì™„ìˆ™", seconds: 120 },
} as const;

type EggKey = keyof typeof EGG_STAGES;

// ìˆœìˆ˜ ê³„ì‚° í•¨ìˆ˜(í…ŒìŠ¤íŠ¸ ê°€ëŠ¥)
export function computeStages(
  recipeKey: string,
  preheatSec: number,
  includeEgg: boolean,
  eggType: EggKey
) {
  const base = RECIPES[recipeKey]?.stages ?? [];
  const out: { label: string; seconds: number }[] = [];
  if (preheatSec > 0) out.push({ label: "ë¬¼ ë“ì´ê¸°", seconds: Math.max(0, preheatSec | 0) });
  out.push(...base);
  if (includeEgg) out.push(EGG_STAGES[eggType]);
  return out;
}

// í¬ë§·í„°
function fmt(sec: number) {
  const s = Math.max(0, sec | 0);
  const m = String(Math.floor(s / 60)).padStart(2, "0");
  const r = String(s % 60).padStart(2, "0");
  return `${m}:${r}`;
}

// íš¨ê³¼ìŒ
function playTone(kind: "beep" | "bell" | "wood" | "mute") {
  if (kind === "mute") return;
  if (typeof window === "undefined") return;
  try {
    // @ts-ignore
    const Actx = window.AudioContext || (window as any).webkitAudioContext;
    const ctx = new Actx();
    const o = ctx.createOscillator();
    const g = ctx.createGain();
    o.connect(g); g.connect(ctx.destination);
    if (kind === "beep") { o.type = "sine"; o.frequency.value = 880; g.gain.value = 0.05; }
    if (kind === "bell") { o.type = "triangle"; g.gain.value = 0.06; o.frequency.value = 700; setTimeout(() => (o.frequency.value = 1200), 120); }
    if (kind === "wood") { o.type = "square"; g.gain.value = 0.05; o.frequency.value = 500; setTimeout(() => g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.2), 50); }
    o.start(); setTimeout(() => { o.stop(); ctx.close(); }, kind === "bell" ? 340 : 200);
  } catch { /* no-op */ }
}

function notify(text: string) {
  if (typeof window === "undefined") return;
  try {
    if (!("Notification" in window)) return;
    // @ts-ignore
    if (Notification.permission === "granted") new Notification(text);
  } catch { /* no-op */ }
}

function requestNotifyPermission() {
  if (typeof window === "undefined") return;
  try {
    if (!("Notification" in window)) return;
    // @ts-ignore
    if (Notification.permission === "default") Notification.requestPermission();
  } catch { /* no-op */ }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ë©”ì¸ ì»´í¬ë„ŒíŠ¸
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
export default function RamenTimerPro() {
  const recipeKeys = Object.keys(RECIPES);
  const [chosen, setChosen] = useState<string>(recipeKeys[0] ?? "ì‹ ë¼ë©´");

  // ì˜µì…˜ ìƒíƒœ
  const [preheatMode, setPreheatMode] = useState<string>("ì—†ìŒ");
  const [preheatSec, setPreheatSec] = useState<number>(0);
  const [toppingEgg, setToppingEgg] = useState<boolean>(false);
  const [eggType, setEggType] = useState<EggKey>("soft");
  const [sound, setSound] = useState<"beep" | "bell" | "wood" | "mute">("beep");

  // íƒ€ì´ë¨¸ ìƒíƒœ
  const [stages, setStages] = useState<{ label: string; seconds: number }[]>(() => computeStages(chosen, preheatSec, toppingEgg, eggType));
  const [stageIdx, setStageIdx] = useState<number>(0);
  const [secondsLeft, setSecondsLeft] = useState<number>(stages[0]?.seconds ?? 0);
  const [running, setRunning] = useState<boolean>(false);
  const timerRef = useRef<number | null>(null);

  // ìŠ¤í…Œì´ì§€ ì¬ê³„ì‚°
  useEffect(() => {
    const next = computeStages(chosen, preheatSec, toppingEgg, eggType);
    setStages(next);
    // í˜„ì¬ ìš”êµ¬ì‚¬í•­: ë‹¨ê³„ê°€ ë°”ë€Œì–´ë„ ìë™ ì‹œì‘ X â†’ ë¦¬ì…‹í•˜ê³  ëŒ€ê¸°
    setStageIdx(0);
    setSecondsLeft(next[0]?.seconds ?? 0);
    stop();
  }, [chosen, preheatSec, toppingEgg, eggType]);

  // ì•ˆì „í•œ setInterval/clearInterval
  function start() {
    if (!stages.length) return;
    requestNotifyPermission();
    if (running) return;
    setRunning(true);
    if (!secondsLeft) setSecondsLeft(stages[stageIdx].seconds);
    // window.setInterval ë°˜í™˜ê°’ì€ number
    timerRef.current = window.setInterval(() => {
      setSecondsLeft((s) => {
        const ns = s - 1;
        if (ns <= 0) {
          // ìë™ìœ¼ë¡œ ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°€ì§€ ì•Šê³  ì •ì§€
          stop();
          notify(`ë‹¨ê³„ ì™„ë£Œ: ${stages[stageIdx]?.label} â€” ë‹¤ìŒ ë‹¨ê³„ë¡œ ì´ë™ í›„ \"ì‹œì‘\"ì„ ëˆ„ë¥´ì„¸ìš”.`);
          return 0;
        }
        return ns;
      });
    }, 1000);
  }

  function pause() {
    setRunning(false);
    if (timerRef.current) window.clearInterval(timerRef.current);
    timerRef.current = null;
  }

  function stop() { pause(); }

  function nextStageManual() {
    if (stageIdx < stages.length - 1) {
      stop();
      const next = stageIdx + 1;
      setStageIdx(next);
      setSecondsLeft(stages[next].seconds);
      playTone(sound);
      notify(`ë‹¤ìŒ ë‹¨ê³„: ${stages[next].label} â€” \"ì‹œì‘\"ì„ ëˆŒëŸ¬ ì§„í–‰`);
    } else {
      stop();
      setSecondsLeft(0);
      playTone("bell");
      notify("ë¼ë©´ ì™„ì„±! ë§›ìˆê²Œ ë“œì„¸ìš” ğŸœ");
    }
  }

  function prevStageManual() {
    if (stageIdx > 0) {
      stop();
      const prev = stageIdx - 1;
      setStageIdx(prev);
      setSecondsLeft(stages[prev].seconds);
      notify(`ì´ì „ ë‹¨ê³„: ${stages[prev].label} â€” \"ì‹œì‘\"ì„ ëˆŒëŸ¬ ì§„í–‰`);
    }
  }

  // UI í—¬í¼
  const barDots = useMemo(() => stages.map((_, i) => (
    <div
      key={i}
      title={`${stages[i].label} Â· ${fmt(stages[i].seconds)}`}
      style={{
        height: 8,
        flex: 1,
        borderRadius: 999,
        background: i < stageIdx ? "#86efac" : i === stageIdx ? "#fde68a" : "#e5e7eb",
      }}
    />
  )), [stages, stageIdx]);

  const recipe = RECIPES[chosen];

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // ê°„ì´ í…ŒìŠ¤íŠ¸ (ê°œë°œ ì½˜ì†”ì—ì„œ ê²°ê³¼ í™•ì¸)
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  useEffect(() => {
    // ê¸°ì¡´ í…ŒìŠ¤íŠ¸ê°€ ì—†ìœ¼ë¯€ë¡œ ê°„ë‹¨í•œ í•©ë¦¬ì„± ê²€ì‚¬ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
    function assert(name: string, cond: boolean) {
      // eslint-disable-next-line no-console
      console[cond ? "log" : "error"](`[%c${cond ? "PASS" : "FAIL"}%c] ${name}`, "color:green;font-weight:bold", "color:inherit");
    }
    const s1 = computeStages("ì‹ ë¼ë©´", 0, false, "soft");
    assert("ì‹ ë¼ë©´: ê¸°ë³¸ ë‹¨ê³„ 2ê°œ", s1.length === 2);
    const s2 = computeStages("ì‹ ë¼ë©´", 90, false, "soft");
    assert("ê°€ì—´ 90ì´ˆ ì¶”ê°€ ì‹œ ì²« ë‹¨ê³„ê°€ ë¬¼ ë“ì´ê¸°", s2[0].label === "ë¬¼ ë“ì´ê¸°" && s2[0].seconds === 90);
    const s3 = computeStages("ì•ˆì„±íƒ•ë©´", 0, true, "hard");
    assert("ê³„ë€ ì™„ìˆ™ ë‹¨ê³„ ì¶”ê°€", s3[s3.length - 1].label.includes("ê³„ë€") && s3[s3.length - 1].seconds === 120);
  }, []);

  return (
    <div style={{ maxWidth: 1120, margin: "0 auto", padding: 24, color: "#111" }}>
      {/* í—¤ë” */}
      <header style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 12 }}>
        <div>
          <h1 style={{ margin: 0, fontSize: 28, fontWeight: 800 }}>ğŸœ ë¼ë©´ íƒ€ì´ë¨¸ PRO</h1>
          <div style={{ fontSize: 12, color: "#6b7280" }}>ëŒ€í‘œ 10ì¢… Â· ë‹¨ê³„ë³„ íƒ€ì´ë¨¸ Â· ê°€ì—´ì‹œê°„ Â· ì•Œë¦¼ Â· ìˆ˜ë™ ë‹¨ê³„ ì´ë™</div>
        </div>
        <div style={{ fontSize: 12, color: "#6b7280" }}>ê°œë°œì: <b>ê°€ì¹˜ìˆëŠ”ë¯¸ë˜êµìœ¡ì—°êµ¬ì†Œ ëŒ€í‘œ ê¹€ë³‘ì°¬</b></div>
      </header>

      {/* ë ˆì‹œí”¼ ìš”ì•½ */}
      <section style={{ background: "#fff", border: "1px solid #e5e7eb", borderRadius: 16, padding: 16, boxShadow: "0 2px 6px rgba(0,0,0,.06)", marginBottom: 16 }}>
        <details>
          <summary style={{ cursor: "pointer", fontWeight: 700 }}>ëŒ€í‘œ ë¼ë©´ 10ì¢… ìµœì  ë ˆì‹œí”¼ ìš”ì•½</summary>
          <div style={{ display: "grid", gap: 12, gridTemplateColumns: "repeat(auto-fit,minmax(260px,1fr))", marginTop: 12 }}>
            {recipeKeys.map((k) => (
              <div key={k} style={{ border: "1px solid #e5e7eb", borderRadius: 12, padding: 12 }}>
                <div style={{ display: "flex", justifyContent: "space-between", marginBottom: 6 }}>
                  <div style={{ fontWeight: 700 }}>{k}</div>
                  <div style={{ fontSize: 12, color: "#6b7280" }}>ë¬¼: {RECIPES[k].water}</div>
                </div>
                <ul style={{ paddingLeft: 18, margin: 0 }}>
                  {RECIPES[k].steps.map((s, i) => (
                    <li key={i}>{s}</li>
                  ))}
                </ul>
              </div>
            ))}
          </div>
        </details>
      </section>

      {/* ì»¨íŠ¸ë¡¤ + íƒ€ì´ë¨¸ */}
      <section style={{ display: "grid", gap: 16, gridTemplateColumns: "1fr 1fr" }}>
        {/* ì¢Œì¸¡ ì»¨íŠ¸ë¡¤ */}
        <div style={{ background: "#fff", border: "1px solid #e5e7eb", borderRadius: 16, padding: 16 }}>
          <div style={{ marginBottom: 12 }}>
            <label style={{ fontWeight: 700 }}>ë¼ë©´ ì„ íƒ</label>
            <select
              value={chosen}
              onChange={(e) => setChosen(e.target.value)}
              style={{ width: "100%", padding: 10, borderRadius: 12, border: "1px solid #ccc", marginTop: 6 }}
            >
              {recipeKeys.map((k) => (
                <option key={k} value={k}>{k}</option>
              ))}
            </select>
          </div>

          <div style={{ display: "grid", gap: 8, gridTemplateColumns: "1fr 1fr", marginBottom: 12 }}>
            <div style={{ border: "1px solid #e5e7eb", borderRadius: 12, padding: 12 }}>
              <div style={{ fontSize: 12, color: "#6b7280" }}>ê¶Œì¥ ë¬¼</div>
              <div style={{ fontWeight: 700 }}>{recipe.water}</div>
            </div>
            <div style={{ border: "1px solid #e5e7eb", borderRadius: 12, padding: 12 }}>
              <div style={{ fontSize: 12, color: "#6b7280" }}>ë‹¨ê³„ ìˆ˜</div>
              <div style={{ fontWeight: 700 }}>{recipe.stages.length}</div>
            </div>
          </div>

          {/* ê°€ì—´ ì˜µì…˜ */}
          <div style={{ marginBottom: 12 }}>
            <div style={{ fontWeight: 700, marginBottom: 6 }}>ê°€ì—´ ì‹œê°„(ë¬¼ ë“ì´ê¸°) ì¶”ê°€</div>
            <div style={{ display: "flex", gap: 8, flexWrap: "wrap", alignItems: "center" }}>
              {[
                { k: "ì—†ìŒ", s: 0 },
                { k: "ê°€ìŠ¤ë ˆì¸ì§€(ë³´í†µ)", s: 180 },
                { k: "ì¸ë•ì…˜(ë¹ ë¦„)", s: 90 },
              ].map((o) => (
                <button
                  key={o.k}
                  onClick={() => { setPreheatMode(o.k); setPreheatSec(o.s); }}
                  style={{ padding: "8px 12px", borderRadius: 12, border: "1px solid #ccc", background: preheatMode === o.k ? "#111" : "#fff", color: preheatMode === o.k ? "#fff" : "#111" }}
                >{o.k}</button>
              ))}
              <span style={{ fontSize: 12, color: "#6b7280" }}>ì‚¬ìš©ì ì§€ì •(ì´ˆ)</span>
              <input
                type="number"
                min={0}
                style={{ width: 96, padding: 10, borderRadius: 12, border: "1px solid #ccc" }}
                value={preheatMode === "ì‚¬ìš©ì ì§€ì •" ? preheatSec : 0}
                onChange={(e) => { setPreheatMode("ì‚¬ìš©ì ì§€ì •"); setPreheatSec(Math.max(0, Number(e.target.value) || 0)); }}
              />
            </div>
            <div style={{ fontSize: 12, color: "#6b7280", marginTop: 6 }}>ê°€ì—´ ë‹¨ê³„ëŠ” íƒ€ì´ë¨¸ì˜ ì²« ë‹¨ê³„ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤(í™˜ê²½ë³„ í¸ì°¨ ìˆìŒ).</div>
          </div>

          {/* í† í•‘ */}
          <div style={{ marginBottom: 12 }}>
            <div style={{ fontWeight: 700, marginBottom: 6 }}>í† í•‘ ì„ íƒ</div>
            <label style={{ display: "inline-flex", gap: 6, alignItems: "center", marginRight: 8 }}>
              <input type="checkbox" checked={toppingEgg} onChange={(e) => setToppingEgg(e.target.checked)} /> ê³„ë€
            </label>
            <div style={{ opacity: toppingEgg ? 1 : 0.5, marginTop: 6 }}>
              <label style={{ marginRight: 8 }}>
                <input type="radio" name="egg" value="soft" disabled={!toppingEgg} checked={eggType === "soft"} onChange={() => setEggType("soft")} /> ë°˜ìˆ™(â‰ˆ45ì´ˆ)
              </label>
              <label>
                <input type="radio" name="egg" value="hard" disabled={!toppingEgg} checked={eggType === "hard"} onChange={() => setEggType("hard")} /> ì™„ìˆ™(â‰ˆ2ë¶„)
              </label>
            </div>
          </div>

          {/* ì•Œë¦¼ */}
          <div>
            <div style={{ fontWeight: 700, marginBottom: 6 }}>ì•Œë¦¼ìŒ / ë¸Œë¼ìš°ì € ì•Œë¦¼</div>
            {(["beep", "bell", "wood", "mute"] as const).map((k) => (
              <button
                key={k}
                onClick={() => setSound(k)}
                style={{ padding: "8px 12px", borderRadius: 12, border: "1px solid #ccc", marginRight: 8, background: sound === k ? "#111" : "#fff", color: sound === k ? "#fff" : "#111" }}
              >{k === "beep" ? "ì‚‘" : k === "bell" ? "ë²¨" : k === "wood" ? "ìš°ë“œ" : "ë¬´ìŒ"}</button>
            ))}
            <button onClick={() => { requestNotifyPermission(); playTone(sound); }} style={{ padding: "8px 12px", borderRadius: 12, border: "1px solid #ccc" }}>í…ŒìŠ¤íŠ¸</button>
            <div style={{ fontSize: 12, color: "#6b7280", marginTop: 6 }}>ë‹¨ê³„ ì™„ë£Œ/ì™„ë£Œ ì‹œ íš¨ê³¼ìŒê³¼ ë°ìŠ¤í¬í†± ì•Œë¦¼(ê¶Œí•œ í•„ìš”)ì´ ì „ì†¡ë©ë‹ˆë‹¤.</div>
          </div>
        </div>

        {/* ìš°ì¸¡ íƒ€ì´ë¨¸ */}
        <div style={{ background: "#fff", border: "1px solid #e5e7eb", borderRadius: 16, padding: 16, textAlign: "center" }}>
          <div style={{ fontSize: 12, color: "#6b7280" }}>í˜„ì¬ ë‹¨ê³„</div>
          <div style={{ fontSize: 22, fontWeight: 800, marginBottom: 8 }}>{stages[stageIdx]?.label ?? "ì¤€ë¹„"}</div>
          <div style={{ fontSize: 64, fontWeight: 900, letterSpacing: 1 }}>{fmt(secondsLeft)}</div>
          <div style={{ display: "flex", gap: 8, marginTop: 16 }}>{barDots}</div>
          <div style={{ display: "flex", justifyContent: "space-between", fontSize: 12, marginTop: 6 }}>
            {stages.map((s, i) => (
              <span key={i} style={{ fontWeight: i === stageIdx ? 700 : 400, color: i === stageIdx ? "#111" : "#6b7280" }}>{s.label}</span>
            ))}
          </div>
          <div style={{ marginTop: 16, display: "flex", gap: 8, justifyContent: "center", flexWrap: "wrap" }}>
            <button onClick={start} style={{ padding: "8px 12px", borderRadius: 12, border: "1px solid #111", background: "#111", color: "#fff" }}>ì‹œì‘</button>
            <button onClick={pause} style={{ padding: "8px 12px", borderRadius: 12, border: "1px solid #ccc" }}>ì¼ì‹œì •ì§€</button>
            <button onClick={() => { stop(); setStageIdx(0); setSecondsLeft(stages[0]?.seconds ?? 0); }} style={{ padding: "8px 12px", borderRadius: 12, border: "1px solid #ccc" }}>ë¦¬ì…‹</button>
            <button onClick={prevStageManual} style={{ padding: "8px 12px", borderRadius: 12, border: "1px solid #ccc" }}>ì´ì „ ë‹¨ê³„</button>
            <button onClick={nextStageManual} style={{ padding: "8px 12px", borderRadius: 12, border: "1px solid #ccc" }}>ë‹¤ìŒ ë‹¨ê³„</button>
          </div>
        </div>
      </section>

      {/* ì„ íƒ ë ˆì‹œí”¼ ìƒì„¸ */}
      <section style={{ background: "#fff", border: "1px solid #e5e7eb", borderRadius: 16, padding: 16, marginTop: 16 }}>
        <h3 style={{ margin: 0 }}>{chosen} Â· ìµœì  ë ˆì‹œí”¼</h3>
        <ul style={{ marginTop: 8 }}>
          {recipe.steps.map((s, i) => (
            <li key={i}>{s}</li>
          ))}
        </ul>
        <div style={{ fontSize: 12, color: "#6b7280", marginTop: 6 }}>í‘œê¸° ì‹œê°„ì€ í™˜ê²½Â·ê¸°í˜¸ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
      </section>

      <footer style={{ textAlign: "center", fontSize: 12, color: "#6b7280", padding: 24 }}>
        Â© {new Date().getFullYear()} ê°€ì¹˜ìˆëŠ”ë¯¸ë˜êµìœ¡ì—°êµ¬ì†Œ Â· ê°œë°œ: ê¹€ë³‘ì°¬
      </footer>
    </div>
  );
}
